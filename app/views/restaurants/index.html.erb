<h3><a href='restaurants/new'>Add a restaurant</a></h3>

<div class="restaurants">
  <% if @restaurants.any? %>
    <% @restaurants.each do |restaurant| %>
      <div id="restaurant-title">
        <h2><%= link_to restaurant.name, restaurant_path(restaurant) %></h2>
      </div>
      <div id="restaurant-image">
        <% if restaurant.image_file_name %>
          <%= image_tag restaurant.image.url(:thumb) %>
        <% end %>
      </div>
      <div id="reviews">
        <% if restaurant.reviews.any? %>
          <h4>Average rating: <%= star_rating(restaurant.average_rating) %></h4>
          <h3> Reviews: </h3>
          <% restaurant.reviews.each do |review| %>
            <%= review.thoughts + " - #{review.user.email}" %> <br>
            <p>
              <%= link_to "Endorse", review_endorsements_path(review), class: 'endorsements-link' %>
               <span class="endorsements_count"> <%= review.endorsements.count %> </span> <%= 'endorsement'.pluralize(review.endorsements.count) %>
            </p>
          <% end %>
        <% end %>
      </div>
      <div id="buttons">
        <% if restaurant.user == current_user %>
          <%= link_to "Edit #{restaurant.name}", edit_restaurant_path(restaurant) %>
          <%= link_to "Delete #{restaurant.name}", restaurant_path(restaurant), method: :delete %>
        <% end %>
        <% if current_user %>
          <% if !current_user.has_reviewed?(restaurant) %>
            <%= link_to "Review #{restaurant.name}", new_restaurant_review_path(restaurant) %>
          <% end %>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <h1>No restaurants yet</h1>
  <%end%>
</div>
